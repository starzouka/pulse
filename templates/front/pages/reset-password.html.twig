{% extends 'base.html.twig' %}

{% block title %}PULSE - Reinitialiser mot de passe{% endblock %}

{% block body %}
  {% include 'front/partials/_hero_mini.html.twig' with {
    hero_kicker: 'AUTH',
    hero_title: 'Reinitialiser mot de passe',
    hero_sub: 'Choisissez un nouveau mot de passe.',
    breadcrumb_current: 'Reinitialiser mot de passe'
  } %}

  <main class="page">
    <section class="belowHero">
      {% for label, messages in app.flashes %}
        {% for message in messages %}
          <div class="listItem">
            <span>{{ message }}</span>
            <span class="badge {{ label == 'error' ? 'badge--danger' : 'badge--success' }}">{{ label|upper }}</span>
          </div>
        {% endfor %}
      {% endfor %}

      <section class="panel">
        {{ form_start(resetPasswordForm, {attr: {novalidate: 'novalidate'}}) }}
          <input type="hidden" name="token" value="{{ token }}">
          <div class="formGrid">
            <label class="field">
              <span class="field__label">Nouveau mot de passe</span>
              {{ form_widget(resetPasswordForm.plainPassword.first, {attr: {class: 'input', autocomplete: 'new-password'}}) }}
              {{ form_errors(resetPasswordForm.plainPassword.first) }}
            </label>
            <label class="field">
              <span class="field__label">Confirmation</span>
              {{ form_widget(resetPasswordForm.plainPassword.second, {attr: {class: 'input', autocomplete: 'new-password'}}) }}
              {{ form_errors(resetPasswordForm.plainPassword.second) }}
            </label>
          </div>
          <div class="formActions" style="margin-top:12px;">
            <button class="btn btn--primary" type="submit">Mettre a jour</button>
          </div>
        {{ form_end(resetPasswordForm) }}
      </section>

      <div class="panel">
        <div class="panel__head">
          <div>
            <h3 class="panel__title">TABLES UTILISEES</h3>
            <div class="panel__desc">Schema reel + colonnes cles.</div>
          </div>
        </div>
        <div class="list">
          <div class="listItem"><span><b>users</b></span><span class="listItem__meta">password_hash, reset_password_token_hash, reset_password_expires_at</span></div>
        </div>
      </div>

      {% include 'front/partials/_footer.html.twig' %}
    </section>
  </main>

  {% include 'front/partials/_auth_modal.html.twig' %}
{% endblock %}
