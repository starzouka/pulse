{% extends 'base.html.twig' %}

{% block title %}PULSE - Detail tournoi organisateur{% endblock %}

{% block body %}
  {% include 'front/partials/_hero_mini.html.twig' with {
    hero_kicker: 'ORGANISATEUR',
    hero_title: 'Detail tournoi',
    hero_sub: 'Modifier les informations du tournoi et gerer son execution.',
    breadcrumb_current: 'Detail tournoi'
  } %}

  <main class="page">
    <section class="belowHero">
      <div class="layout">
        {% include 'front/partials/_organizer_side_nav.html.twig' with {active: 'tournament_detail'} %}

        <div>
          {% for label, messages in app.flashes %}
            {% for message in messages %}
              <div class="listItem">
                <span>{{ message }}</span>
                <span class="badge {{ label == 'error' ? 'badge--danger' : 'badge--success' }}">{{ label|upper }}</span>
              </div>
            {% endfor %}
          {% endfor %}

          <div class="panel">
            <div class="panel__head">
              <div>
                <h3 class="panel__title">{{ tournament.title }}</h3>
                <div class="panel__desc">Tournoi #{{ tournament.tournamentId }} - {{ tournament.gameId ? tournament.gameId.name : '-' }}</div>
              </div>
              <span class="badge badge--info">{{ tournament.status }}</span>
            </div>

            <div class="statsRow">
              <div class="statCard">
                <div class="statCard__value">{{ registrationsCount }}</div>
                <div class="statCard__label">Inscriptions</div>
              </div>
              <div class="statCard">
                <div class="statCard__value">{{ acceptedRegistrationsCount }}</div>
                <div class="statCard__label">Equipes acceptees</div>
              </div>
              <div class="statCard">
                <div class="statCard__value">{{ matchesCount }}</div>
                <div class="statCard__label">Matchs</div>
              </div>
            </div>

            <div class="card__actions" style="margin-top:10px;">
              <a class="btn btn--ghost" href="{{ path('front_organizer_registrations', {tournament: tournament.tournamentId}) }}">Inscriptions</a>
              <a class="btn btn--ghost" href="{{ path('front_organizer_matches', {tournament: tournament.tournamentId}) }}">Matchs</a>
            </div>
          </div>

          <section class="panel">
            {{ form_start(tournamentForm, {attr: {novalidate: 'novalidate'}}) }}
              {{ form_errors(tournamentForm) }}
              {% include 'shared/_tournament_form_fields.html.twig' with {form: tournamentForm} %}
              <div class="formActions" style="margin-top:12px;">
                <button class="btn btn--primary" type="submit">Enregistrer les modifications</button>
                <a class="btn btn--ghost" href="{{ path('front_organizer_tournaments') }}">Retour</a>
              </div>
            {{ form_end(tournamentForm) }}
          </section>

          <div class="panel">
            <div class="panel__head">
              <div>
                <h3 class="panel__title">TABLES UTILISEES</h3>
                <div class="panel__desc">Donnees extraites depuis le schema reel.</div>
              </div>
            </div>
            <div class="list">
              <div class="listItem">
                <span><b>tournaments</b></span>
                <span class="listItem__meta">title, status, dates, max_teams, registration_mode, prize_pool, photo_path</span>
              </div>
              <div class="listItem">
                <span><b>tournament_teams</b></span>
                <span class="listItem__meta">tournament_id, team_id, status</span>
              </div>
              <div class="listItem">
                <span><b>matches</b></span>
                <span class="listItem__meta">match_id, tournament_id, status, scheduled_at</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      {% include 'front/partials/_footer.html.twig' %}
    </section>
  </main>

  {% include 'front/partials/_auth_modal.html.twig' %}
{% endblock %}
